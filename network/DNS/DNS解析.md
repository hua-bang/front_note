### DNS解析

#### 用户在游览器的地址栏敲入网址，发生了啥？

- 用户在浏览器的地址栏中敲入了网站的网址
- 浏览器查找域名的IP地址
- 找到ip地址后，浏览器给web服务器发送一个HTTP请求
- 服务器“处理”请求
- 服务器发回一个HTML响应
- 浏览器开始显示HTML

#### DNS域名解析过程：

- 查找游览器缓存
  - 游览器会检测缓存中有没有这个域名对应的解析过的ip地址，如果缓存中有，则解析过程结束
  - 游览器缓存大小有限，时间有限。
- 查找本地系统缓存
  - 如果用户的游览器缓存中没有，游览器会查找操作系统中是否由这个域名对应的DNS缓存，同时，操作系统也有一个域名解析的过程，hosts文件可以设置域名的解析。
- 查找路由器缓存
  - 系统缓存也没有，则请求发向服务器
- 查找ISP DNS服务器
  - 如果上述的方法，还没找到，就访问isp dns服务器，操作系统会将这个域名发送给本地域名服务器，通过ispDNS服务器缓存
- 递归搜索
  - 在前面都没有命中情况下
    - 本地dns请求互联网的根域
    - 根域返回所要查询的顶级域的ip给到本地
    - 本地dns在通过顶级域发送请求
    - 顶级域在讲域名中的二级域的ip分会给本地dns
    - 本地dns再向二级域名发送请求
    - 不断重复，直到得到最后结果放回本机
    - 可以访问网站啦

#### 安全问题

1. DNS欺骗

   - 使用了一个恶意dns的错误信息，dns欺骗
   - 分类
     - 缓存感染：黑客讲数据放一个没有设防的DNS服务器缓存中
     - DNS信息劫持
     - DNS重定向

2. 拒绝服务攻击

   黑客利用DNS漏洞，讲dns的服务关闭暂停

3. 分布式拒绝服务攻击（DDOS）

   DDOS 攻击通过使用攻击者控制的几十台或几百台计算机攻击一台主机，使得服务拒绝攻击更难以防范，更难以通过阻塞单一攻击源主机的数据流，来防范服务拒绝攻击。

4. 缓存区漏洞溢出攻击

   攻击者利用dns服务器存在的漏洞，构造特殊数据包来向dns进行缓冲区溢出攻击，一旦成功dns服务停止，也可以能造成攻击者再dns服务器执行设置的脚本。

#### DNS有关网络性能优化

1. 减少DNS查找，避免重定向

   - 使用游览器DNS缓存，服务器DNS缓存，扽会给来减少DNS缓存

2. DNS预解析

   - 声明meta，表示这个亚目要做DNS预解析

     ```html
     <meta http-equiv="x-dns-prefetch-control" content="on" />
     ```

   - 使用link便签做强制DNS预解析

     ```html
     <link rel="dns-prefetch" href="http://ke.qq.com/" />
     ```

     